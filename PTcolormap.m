%% PTcolormap - creates a few novel, more linear, colormap options
% this is a good place to continue improving colormaps 
%
% ----------------------------------------------------------------------------------
% "THE BEER-WARE LICENSE" (Revision 42):
% <brian.white@queensu.ca> wrote this file. As long as you retain this notice you
% can do whatever you want with this stuff. If we meet some day, and you think
% this stuff is worth it, you can buy me a beer in return. -Brian White
% ----------------------------------------------------------------------------------


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1) parulaMod similar to plasmatree (familiar to community)
a=colormap(parula);
parulaMod=[smooth(a(:,1),500) smooth(a(:,2),500) smooth(a(:,3),500)*.6];
%parulaMod=[a(:,1) a(:,2) a(:,3)*.6];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 2) a couple more linear, gamma corrected, cmaps using dkl colorspace 
% http://www.scholarpedia.org/article/Color_spaces

% 64 steps from -1 to 1, DKL color range
i=.01:1/64:1;%half
i2=-1:1/31.9:1;%full

% DKL 'red' white bg 
for j=1:64, 
    linearREDcmap(j,:)=dkl2rgb([-i2(j) i(j) 0])./255; 
end
% DKL 'grey' white bg
for j=1:64, 
    linearGREYcmap(j,:)=dkl2rgb([-i2(j) 0 0])./255; 
end

% convert dkl cone opponent colors to rgb
function rgb = dkl2rgb(dkl)
    % rgb = dkl2rgb(dkl)
    % input (dkl) is the 3 dimensions in dkl color space = [luminance axis ; red/green axis ; blue/yellow axis] ;  
     % 'magic numbers', based on 'average' crt monitor and derived using
     % Smith & Pokorny cone fundamentals % V. C. Smith & J. Pokorny (1975), Vision Res. 15, 161-172.
      M_dkl2rgb = [
        1.0000    1.0000   -0.3495
        1.0000   -0.3203    0.3113
        1.0000    0.0133   -1.0000
        ];

    % convert outputs a floating point
    rgb = 0.5 + M_dkl2rgb*(dkl')/2;

    % convert to uint8
    rgb = uint8(rgb*255);

   % gamma corrected RGB based on 'average' monitor
    rgb(rgb<1)=1;

    gamma_corr=[ 0     0    14
        10    11    17
        18    18    19
        24    23    21
        29    28    23
        33    31    25
        36    35    27
        40    38    29
        43    40    31
        45    43    33
        48    46    34
        51    48    36
        53    50    38
        55    53    39
        58    55    41
        60    57    42
        62    59    44
        64    61    45
        66    63    47
        68    64    48
        69    66    50
        71    68    51
        73    70    53
        75    71    54
        76    73    55
        78    75    57
        80    76    58
        81    78    59
        83    79    60
        84    81    62
        86    82    63
        87    84    64
        88    85    66
        90    86    67
        91    88    68
        93    89    69
        94    91    70
        95    92    72
        97    93    73
        98    94    74
        99    96    75
       100    97    76
       102    98    77
       103    99    78
       104   101    80
       105   102    81
       107   103    82
       108   104    83
       109   105    84
       110   107    85
       111   108    86
       112   109    87
       113   110    88
       115   111    89
       116   112    90
       117   113    91
       118   114    93
       119   115    94
       120   116    95
       121   117    96
       122   119    97
       123   120    98
       124   121    99
       125   122   100
       126   123   101
       127   124   102
       128   125   103
       129   126   104
       130   127   105
       131   128   106
       132   129   107
       133   130   108
       134   130   108
       135   131   109
       136   132   110
       137   133   111
       138   134   112
       139   135   113
       139   136   114
       140   137   115
       141   138   116
       142   139   117
       143   140   118
       144   141   119
       145   142   120
       146   142   121
       147   143   122
       147   144   122
       148   145   123
       149   146   124
       150   147   125
       151   148   126
       152   148   127
       153   149   128
       153   150   129
       154   151   130
       155   152   131
       156   153   131
       157   153   132
       157   154   133
       158   155   134
       159   156   135
       160   157   136
       161   158   137
       161   158   137
       162   159   138
       163   160   139
       164   161   140
       165   162   141
       165   162   142
       166   163   143
       167   164   143
       168   165   144
       168   165   145
       169   166   146
       170   167   147
       171   168   148
       171   168   148
       172   169   149
       173   170   150
       174   171   151
       174   172   152
       175   172   152
       176   173   153
       176   174   154
       177   174   155
       178   175   156
       179   176   157
       179   177   157
       180   177   158
       181   178   159
       181   179   160
       182   180   160
       183   180   161
       184   181   162
       184   182   163
       185   182   164
       186   183   164
       186   184   165
       187   184   166
       188   185   167
       188   186   168
       189   187   168
       190   187   169
       190   188   170
       191   189   171
       192   189   171
       192   190   172
       193   191   173
       194   191   174
       194   192   174
       195   193   175
       196   193   176
       196   194   177
       197   195   178
       198   195   178
       198   196   179
       199   197   180
       200   197   181
       200   198   181
       201   199   182
       201   199   183
       202   200   184
       203   201   184
       203   201   185
       204   202   186
       205   203   186
       205   203   187
       206   204   188
       206   204   189
       207   205   189
       208   206   190
       208   206   191
       209   207   192
       210   208   192
       210   208   193
       211   209   194
       211   209   194
       212   210   195
       213   211   196
       213   211   197
       214   212   197
       214   213   198
       215   213   199
       216   214   200
       216   214   200
       217   215   201
       217   216   202
       218   216   202
       218   217   203
       219   217   204
       220   218   204
       220   219   205
       221   219   206
       221   220   207
       222   220   207
       223   221   208
       223   222   209
       224   222   209
       224   223   210
       225   223   211
       225   224   211
       226   225   212
       227   225   213
       227   226   214
       228   226   214
       228   227   215
       229   227   216
       229   228   216
       230   229   217
       230   229   218
       231   230   218
       232   230   219
       232   231   220
       233   231   220
       233   232   221
       234   233   222
       234   233   222
       235   234   223
       235   234   224
       236   235   224
       236   235   225
       237   236   226
       238   237   226
       238   237   227
       239   238   228
       239   238   228
       240   239   229
       240   239   230
       241   240   230
       241   240   231
       242   241   232
       242   241   232
       243   242   233
       243   243   234
       244   243   234
       244   244   235
       245   244   236
       246   245   236
       246   245   237
       247   246   238
       247   246   238
       248   247   239
       248   247   240
       249   248   240
       249   248   241
       250   249   242
       250   250   242
       251   250   243
       251   251   244
       252   251   244
       252   252   245
       253   252   245
       253   253   246
       254   253   247
       254   254   247];

    rgb2 = [gamma_corr(rgb(1),1); gamma_corr(rgb(2),2); gamma_corr(rgb(3),3)];
    rgb = rgb2;
end





